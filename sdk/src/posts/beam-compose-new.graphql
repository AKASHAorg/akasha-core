fragment BeamFragment on AkashaBeam{
  id
  reflectionsCount
  active
  embeddedBeam{
    label
    embeddedID
  }
  author{
    id
    isViewer
  }
  content {
    blockID
    order
  }
  tags
  version
  createdAt
  nsfw
  reflections(last: 1){
    edges {
      cursor
    }
    pageInfo {
      hasNextPage
      hasPreviousPage
      startCursor
      endCursor
    }
  }
}

fragment ContentBlockFragment on AkashaContentBlock{
  id
  content {
    propertyType
    value
    label
  }
  active
  appVersion {
    application {
      name
      displayName
      id
    }
    applicationID
    id
    version
  }
  appVersionID
  createdAt
  kind
  author {
    id
    isViewer
  }
  version
  nsfw
}

fragment BlockStorageFragment on AkashaBlockStorage {
  appVersionID
  appVersion {
    application {
      name
      displayName
      id
    }
    applicationID
    id
    version
  }
  createdAt
  active
  version
  content {
    propertyType
    label
    value
  }
  author {
    id
    isViewer
  }

  blockID
  block {
    id
    active
    author {
      id
      isViewer
    }
  }

}

query GetBeams($after: String, $before: String, $first: Int, $last: Int, $filters: AkashaBeamFiltersInput, $sorting: AkashaBeamSortingInput){
  akashaBeamIndex(after: $after, before: $before, first: $first, last: $last, filters: $filters, sorting: $sorting){
    edges {
     node {
       ...BeamFragment
     }
      cursor
    }
    pageInfo {
      startCursor
      endCursor
      hasNextPage
      hasPreviousPage
    }
  }
}

query GetBeamsByAuthorDid($id: ID!, $after: String, $before: String, $first: Int, $last: Int,  $filters: AkashaBeamFiltersInput, $sorting: AkashaBeamSortingInput){
  node(id: $id){
    ... on CeramicAccount{
      akashaBeamList(after: $after, before: $before, first: $first, last: $last, filters: $filters, sorting: $sorting){
        edges {
          node {
            ...BeamFragment
          }
          cursor
        }
        pageInfo {
          startCursor
          endCursor
          hasNextPage
          hasPreviousPage
        }
      }
      isViewer
    }
  }
}

query GetBeamById($id: ID!){
  node(id: $id){
    ... on AkashaBeam{
      ...BeamFragment
    }
  }
}

query GetContentBlockById($id: ID!){
  node(id: $id){
    ... on AkashaContentBlock{
      ...ContentBlockFragment
    }
  }
}

query GetBlockStorageById($id: ID!){
  node(id: $id){
    ... on AkashaBlockStorage{
      ...BlockStorageFragment
    }
  }
}


mutation CreateBeam($i: CreateAkashaBeamInput!){
  createAkashaBeam(input: $i){
    document {
      ...BeamFragment
    }
    clientMutationId
  }
}

mutation UpdateBeam($i: UpdateAkashaBeamInput!){
  updateAkashaBeam(input: $i){
    document {
      ...BeamFragment
    }
    clientMutationId
  }
}

mutation CreateContentBlock($i: CreateAkashaContentBlockInput!){
  createAkashaContentBlock(input: $i){
    document {
      ...ContentBlockFragment
    }
    clientMutationId
  }
}


mutation UpdateContentBlock($i: UpdateAkashaContentBlockInput!){
  updateAkashaContentBlock(input: $i){
    document {
      ...ContentBlockFragment
    }
    clientMutationId
  }
}
