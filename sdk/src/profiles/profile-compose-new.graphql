
fragment UserProfileFragment on AkashaProfile{
  id
  did{
    id
    isViewer
  }
  name
  links{
    href
    label
  }
  background {
    alternatives {
      src
      width
      height
    }
    default {
      src
      width
      height
    }
  }
  description
  avatar {
    default {
      src
      width
      height
    }
    alternatives {
      src
      width
      height
    }
  }

  followers(last: 5){
   pageInfo {
     startCursor
     endCursor
     hasPreviousPage
     hasNextPage
   }
  }

  createdAt
  nsfw
}
# id of the profile document
query GetProfileByID($id: ID!) {
  node(id: $id) {
    ...on AkashaProfile {
      ...UserProfileFragment
    }
  }
}
# id is the did string of the account
query GetProfileByDid($id: ID!) {
  node(id: $id) {
    ...on CeramicAccount {
      akashaProfile {
        ...UserProfileFragment
      }
      isViewer
    }
  }
}

query GetProfiles($after: String, $before: String, $first: Int, $last: Int, $filters: AkashaProfileFiltersInput, $sorting: AkashaProfileSortingInput ){
  akashaProfileIndex(after: $after, before: $before, first: $first, last: $last, filters: $filters, sorting: $sorting ){
    edges {
      node {
        ...UserProfileFragment
      }
      cursor
    }
    pageInfo {
      startCursor
      endCursor
      hasNextPage
      hasPreviousPage
    }
  }
}

# saved interests for all documents, might be useful at some point
query GetInterests($after: String, $before: String, $first: Int, $last: Int){
  akashaProfileInterestsIndex(after: $after, before: $before, first: $first, last: $last ){
    edges {
      node {
        topics {
          value
          labelType
        }
        did {
          id
        }
        id
      }
      cursor
    }
    pageInfo {
      startCursor
      endCursor
      hasNextPage
      hasPreviousPage
    }
  }
}

# get all interests for a specific DID account
query GetInterestsByDid($id: ID!){
  node(id: $id){
    ... on CeramicAccount{
      akashaProfileInterests {
        topics {
          value
          labelType
        }
        did {
          id
        }
        id
      }
      isViewer
    }
  }
}

# get interests from a specific Interests document id
query GetInterestsById($id: ID!){
  node(id: $id){
    ... on AkashaProfileInterests{
      topics {
        value
        labelType
      }
      did {
        id
      }
      id
    }
  }
}
# get following
query GetFollowingListByDid($id: ID!, $after: String, $before: String, $first: Int, $last: Int, $sorting: AkashaFollowSortingInput){
  node(id: $id){
    ... on CeramicAccount{
      akashaFollowList(after: $after, before: $before, first: $first, last: $last, filters: {where: {isFollowing: {equalTo: true}}}, sorting: $sorting){
        edges {
          node {
            id
            isFollowing
            profileID
            profile {
             ...UserProfileFragment
            }
            did {
              id
            }
          }
          cursor
        }
        pageInfo {
          startCursor
          endCursor
          hasNextPage
          hasPreviousPage
        }
      }
      isViewer
    }
  }
}

# get followers
query GetFollowersListByDid($id: ID!, $after: String, $before: String, $first: Int, $last: Int, $sorting: AkashaFollowSortingInput){
  node(id: $id){
    ... on CeramicAccount{
      akashaProfile {
        followers(after: $after, before: $before, first: $first, last: $last, filters: {where: {isFollowing: {equalTo: true}}}, sorting: $sorting){
          edges {
            node {
              id
              isFollowing
              profileID
              profile {
                ...UserProfileFragment
              }
              did {
                akashaProfile {
                  ...UserProfileFragment
                }
              }
            }
            cursor
          }
          pageInfo {
            startCursor
            endCursor
            hasNextPage
            hasPreviousPage
          }
        }
      }
      isViewer
    }
  }

}

query GetMyProfile{
  viewer {
    akashaProfile {
      ...UserProfileFragment
    }
  }
}

query GetFollowDocument($follower: ID!, $following: String!){
  node(id: $follower){
    ... on CeramicAccount{
      akashaProfile {
        followers(last: 1, filters: {where: {profileID: {equalTo: $following}}}){
          edges {
            node {
              id
              isFollowing
              profileID
              profile {
                ...UserProfileFragment
              }
            }
            cursor
          }
          pageInfo {
            startCursor
            endCursor
            hasNextPage
            hasPreviousPage
          }
        }
      }
      isViewer
    }
  }
}


query GetFollowDocuments($follower: ID!, $following: [String!]){
  node(id: $follower){
    ... on CeramicAccount{
      akashaProfile {
        followers(last: 25, filters: {where: {profileID: {in: $following}}}){
          edges {
            node {
              id
              isFollowing
              profileID
              profile {
                ...UserProfileFragment
              }
            }
            cursor
          }
          pageInfo {
            startCursor
            endCursor
            hasNextPage
            hasPreviousPage
          }
        }
      }
      isViewer
    }
  }
}

# create new Profile document attached to did
mutation CreateProfile($i: CreateAkashaProfileInput!){
  createAkashaProfile(input: $i){
    document {
      ...UserProfileFragment
    }
    clientMutationId
  }
}

# update an existing Profile document
mutation UpdateProfile($i: UpdateAkashaProfileInput!){
  updateAkashaProfile(input: $i){
    document {
      ...UserProfileFragment
    }
    clientMutationId
  }
}

# create an Interests document for the authenticated Did account
mutation CreateInterests($i: CreateAkashaProfileInterestsInput!){
  createAkashaProfileInterests(input: $i){
    document {
      topics {
        value
        labelType
      }
      did {
        id
      }
      id
    }
    clientMutationId
  }
}

# update an existing Interests document for the authenticated Did account
mutation UpdateInterests($i: UpdateAkashaProfileInterestsInput!){
  updateAkashaProfileInterests(input: $i){
    document {
      topics {
        value
        labelType
      }
      did {
        id
      }
      id
    }
    clientMutationId
  }
}

mutation CreateFollow($i: CreateAkashaFollowInput!){
  createAkashaFollow(input: $i){
    document {
      isFollowing
      profile {
        ...UserProfileFragment
      }
      did {
        id
      }
      id
    }
  }
}

mutation UpdateFollow($i: UpdateAkashaFollowInput!){
  updateAkashaFollow(input: $i){
    document {
      isFollowing
      profile {
        ...UserProfileFragment
      }
      did {
        id
      }
      id
    }
  }
}
